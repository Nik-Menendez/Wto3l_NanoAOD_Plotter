import numpy as np

def Fake_weight(data,s):

	leps = ["L1","L2","L3"]

	fw_final = np.ones(len(data["etaL3"]))
	#fw_final = np.zeros(len(data["etaL3"]))
	for l in leps:
		#pt_bins = [5, 10, 15, 20, 30, 60]
		pt_bins = [5, 8, 10, 12, 15, 20, 30, 100]
		#pt_bins = [5, 8, 10, 12, 15, 20, 30, 60, 100]
		
		#######################################

		# Iso with DY
		#fwb = [0.5213243449740924, 0.4539697512749899, 0.30606046980933466, 0.14351602744021769, 0.13131328717272245]
		#fwe = [0.7588660259738994, 0.5383173170757738, 0.4787550456704265, 0.4922575968897811, 0.20729745999935842]

		# Iso with 06Pre and Tight
		#fwb = [0.5314712822245141, 0.3297449744933238, 0.45037104205104245, 0.35110745709757957, 0.13512725700195355, 0.1253224439349916, 0.10120954450840185, -1.24275619657346]
		#fwe = [0.7969624529631087, 0.5713386884190845, 0.8110930708475008, 0.4820063006050261, 0.5038472568828178, 0.8794044021506442, 0.07116872136635795, -1.2280969716813916]

		# mva with DY
		#fwb = [0.2176227034428837, 0.6846290906276429, 1.2523593652480287, 1.6741493816502808, 1.5159613990002045, 1.0348529784189802, -0.06250562118318956]
		#fwe = [0.16777667031726248, 1.3823396734447488, 2.384587292006198, 1.1137189316757024, 1.7605583169793841, 2.7999780812495505, 0.13771850995540263]

		# mva with no pre-cut
		#fwb = [0.02475222635308323, 0.11762092518698808, 0.28321861661400677, 0.3094595358524776, 0.0023016137207275728, 0.00161146513718911, -5.3654218847285486e-05]
		#fwe = [0.01724095561602706, 0.23459732639248082, 0.29496634607093863, 0.08044185236636933, 0.008078313454920766, 0.002751606336558247, 9.281399153749995e-05]

		# mva with mediumId pre-cut
		#fwb = [0.05541416161896958, 0.2486790467422362, 0.5808784345843323, 0.7874840364127129, 0.9137338893139219, 0.9764963031246467, -1.7122768272080116]
		#fwe = [0.02922238113846306, 0.45664748828310187, 0.8149828680081836, 0.3875312411412715, 1.4026702568793523, 1.4764353564322037, 0.30064276475629403]

		# mva with mediumId and looser pre-cuts
		fwb = [0.050695819229640476, 0.20944823291858786, 0.5069358955974183, 0.6852340983081718, 0.9058359512543949, 1.1069220897114456, -1.7969341925432447]
		fwe = [0.02897323317043545, 0.42550431196673777, 0.7660740817436834, 0.5021882341955523, 1.5423808639681666, 1.4744995082815637, 0.06214394384364812]

		# mva with noId and looser pre-cuts
		#fwb = [0.02322641202901608, 0.10711375610692069, 0.26515779258754435, 0.2737295125333646, 0.0022061545180259547, 0.0015809247306550714, -0.000018633521135574428]
		#fwe = [0.01725078950001117, 0.2252084822959649, 0.285109152975939, 0.09639149696140364, 0.007398195929654668, 0.0025676518557816133, 0.000131583344544645]
		#fwb = [x*1.42 for x in fwb]
		#fwe = [x*1.42 for x in fwe]

		barrel = np.abs(data["eta%s"%(l)]) <= 1.2
		endcap = np.abs(data["eta%s"%(l)]) >= 1.2

		pTbin = [0]*len(fwb)
		for i in range(len(pTbin)):
			#pTbin[i] = (data["pT%s"%(l)] >= pt_bins[i]) & (data["pT%s"%(l)] < pt_bins[i+1]) & (data["Iso%s"%(l)] > 0.3)
			pTbin[i] = (data["pT%s"%(l)] >= pt_bins[i]) & (data["pT%s"%(l)] < pt_bins[i+1]) & (data["mvaId%s"%(l)] <= 1)

		fwb_final, fwe_final = 0,0
		for i in range(len(fwb)):
			fwb_final += pTbin[i]*fwb[i]
			fwe_final += pTbin[i]*fwe[i]
		fwb_final *= barrel
		fwe_final *= endcap

		fw = fwb_final + fwe_final
		for i in range(len(fw)):
			if fw[i]==0: fw[i]=1
		fw_final *= fw
		#fw_final += fw

	return fw_final
